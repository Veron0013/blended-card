{"version":3,"file":"index.js","sources":["../src/js/products-api.js","../src/home.js"],"sourcesContent":["// Функції для роботи з бекендом\nimport axios from \"axios\";\nimport refs from \"./refs\";\n\nexport async function getApiData(url) {\n\treturn await axios.get(url)\n\t\t.then(data => data)\n\t\t.catch(error => error.message);\n};\n\nexport const buildQuery = (base, page, limit) => {\n\treturn `${base}?limit=${limit}&skip=${(page - 1) * limit}`;\n};\n","//Логіка сторінки Home\nimport refs from \"./js/refs.js\";\nimport * as render from \"./js/render-function.js\";\nimport * as apiRest from \"./js/products-api.js\";\nimport * as storageLib from \"./js/storage.js\";\n\n\n\nconst renderCategories = async () => {\n\n\ttry {\n\t\tconst dataCat = await apiRest.getApiData(refs.qCategories);\n\t\tconsole.log(dataCat);\n\t\trender.createMarcup(refs.categoryList, dataCat.data, render.markUpCategories, true);\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\n}\nconst renderProducts = async (queryLink, loadMore = false) => {\n\trender.showViewElement(refs.load_more, \"hidden\");\n\trender.hideViewElement(refs.divNotFound, \"not-found--visible\");\n\n\ttry {\n\t\tconst dataProd = await apiRest.getApiData(queryLink);\n\t\tconst N_F = !Array.isArray(dataProd.data?.products) || dataProd.data.products.length === 0;\n\t\tconsole.log(queryLink, N_F);\n\n\t\tif (!Array.isArray(dataProd.data?.products) || dataProd.data.products.length === 0) {\n\t\t\trender.showViewElement(refs.divNotFound, \"not-found--visible\");\n\t\t}\n\t\t//console.log(dataProd);\n\t\trender.createMarcup(refs.productList, dataProd.data.products, render.markUpProducts, !loadMore);\n\t\trefs.totalItems = dataProd.data.total;\n\n\t\tconsole.log(refs.totalItems, refs.currentPage * refs.defLimit);\n\n\t\tif (refs.totalItems > refs.currentPage * refs.defLimit) {\n\t\t\trender.hideViewElement(refs.load_more, \"hidden\");\n\t\t}\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\tfinally {\n\t\trefs.load_more.disabled = false;\n\t}\n}\nconst renderProductsModal = async (queryLink) => {\n\ttry {\n\t\tconst dataProd = await apiRest.getApiData(queryLink);\n\t\tconsole.log(dataProd.data, \"render\", refs.productModal);\n\t\trender.createMarcup(refs.productModal, dataProd.data, render.markUpProductModal, true);\n\t\trender.showViewElement(refs.sectionModal, 'modal--is-open');\n\t\t//refs.sectionModal.classList.add('modal--is-open');\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n}\n\nrefs.categoryList.addEventListener(\"click\", (e) => {\n\tconst li = e.target.closest(\".categories__item\");\n\tif (!li) return;\n\n\trefs.currentPage = 1;\n\trender.clearElement(refs.productList);\n\trefs.currentQuery = li.dataset.url;\n\n\t//const vQuery = refs.currentQuery + `?limit=12&skip=${(refs.currentPage - 1) * 12}`;\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit);\n\trenderProducts(vQuery);\n});\nrefs.productList.addEventListener(\"click\", (e) => {\n\tconst prodEl = e.target.closest(\".products__item\");\n\tif (!prodEl) return;\n\n\tconsole.log(prodEl);\n\tconst prodId = prodEl.dataset.id;\n\n\tconst vQuery = refs.BASE_URL + `/${prodId}`;\n\tconsole.log(vQuery);\n\n\trenderProductsModal(vQuery);\n});\nrefs.load_more.addEventListener(\"click\", (e) => {\n\trefs.load_more.disabled = true;\n\trefs.currentPage++;\n\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit);\n\t//onst vQuery = refs.currentQuery + `&limit=${refs.defLimit}&skip=${(refs.currentPage - 1) * refs.defLimit}`;\n\tconsole.log(vQuery);\n\trenderProducts(vQuery, true);\n\n});\n\nrefs.closeBtnModal.addEventListener(\"click\", (e) => {\n\trender.hideViewElement(refs.sectionModal, 'modal--is-open');\n\t//.classList.remove('modal--is-open');\n});\nrefs.searchForm.addEventListener(\"submit\", (e) => {\n\te.preventDefault();\n\n\tlocalStorage.clear();\n\n\trefs.currentPage = 1;\n\t//renderTools.clearElement(renderTools.productList);\n\tconst searchData = e.currentTarget.elements['searchValue'].value.trim();\n\n\tif (!searchData) return;\n\n\tif (searchData.length < 1) return;\n\trefs.currentQuery = refs.BASE_URL + `/search?q=${searchData}`;\n\tconst vQuery = `${refs.currentQuery}&limit=${refs.defLimit}&skip=${(refs.currentPage - 1) * refs.defLimit}`;\n\tconsole.log(vQuery);\n\n\trenderProducts(vQuery);\n});\n\nrefs.addToCart.addEventListener(\"click\", (e) => {\n\tstorageLib.confirmAndCloseModal(refs.addToCart, refs.CD_DATA);\n});\nrefs.addToWishList.addEventListener(\"click\", (e) => {\n\tstorageLib.confirmAndCloseModal(refs.addToWishList, refs.WL_DATA);\n});\n\n//////// main load\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\tconsole.log(\"home\");\n\n\trenderCategories();\n});\n"],"names":["getApiData","url","axios","data","error","buildQuery","base","page","limit","renderCategories","dataCat","apiRest.getApiData","refs","render.createMarcup","render.markUpCategories","e","renderProducts","queryLink","loadMore","render.showViewElement","render.hideViewElement","dataProd","N_F","_a","_b","render.markUpProducts","renderProductsModal","render.markUpProductModal","li","render.clearElement","cPage","vQuery","apiRest.buildQuery","prodEl","prodId","searchData","storageLib.confirmAndCloseModal"],"mappings":"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"}