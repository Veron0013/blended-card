{"version":3,"file":"index.js","sources":["../src/home.js"],"sourcesContent":["//Логіка сторінки Home\nimport refs from \"./js/refs.js\";\nimport * as render from \"./js/render-function.js\";\nimport * as apiRest from \"./js/products-api.js\";\nimport * as storageLib from \"./js/storage.js\";\n\nconst renderCategories = async () => {\n\n\ttry {\n\t\tconst dataCat = await apiRest.getApiData(refs.qCategories);\n\t\t//console.log(dataCat);\n\t\trender.createMarcup(refs.categoryList, dataCat.data, render.markUpCategories, true);\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\n}\nconst renderProducts = async (queryLink, loadMore = false) => {\n\trender.showViewElement(refs.load_more, \"hidden\");\n\trender.hideViewElement(refs.divNotFound, \"not-found--visible\");\n\n\ttry {\n\t\tconst dataProd = await apiRest.getApiData(queryLink);\n\t\tconst N_F = !Array.isArray(dataProd.data?.products) || dataProd.data.products.length === 0;\n\n\t\tif (N_F) {\n\t\t\trender.showViewElement(refs.divNotFound, \"not-found--visible\");\n\t\t}\n\t\t//console.log(dataProd);\n\t\trender.createMarcup(refs.productList, dataProd.data.products, render.markUpProducts, !loadMore);\n\t\trefs.totalItems = dataProd.data.total;\n\n\t\t//console.log(refs.totalItems, refs.currentPage * refs.defLimit);\n\n\t\tif (refs.totalItems > refs.currentPage * refs.defLimit) {\n\t\t\trender.hideViewElement(refs.load_more, \"hidden\");\n\t\t}\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\tfinally {\n\t\trefs.load_more.disabled = false;\n\t}\n}\nconst renderProductsModal = async (queryLink) => {\n\ttry {\n\t\tconst dataProd = await apiRest.getApiData(queryLink);\n\t\t//console.log(dataProd.data, \"render\", refs.productModal);\n\t\trender.createMarcup(refs.productModal, dataProd.data, render.markUpProductModal, true);\n\t\trender.showViewElement(refs.sectionModal, 'modal--is-open');\n\n\t\trefs.inWishList = render.updateButtonState(refs.addToWishList, refs.WL_DATA, refs.TW_ADD, refs.TW_REMOVE, storageLib.isInWishListBind);\n\n\t\trefs.inCardList = render.updateButtonState(refs.addToCart, refs.CD_DATA, refs.TC_ADD, refs.TC_REMOVE, storageLib.isInCardListBind);\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n}\n\nrefs.categoryList.addEventListener(\"click\", (e) => {\n\tconst li = e.target.closest(\".categories__item\");\n\tif (!li) return;\n\n\trefs.isSearch = false;\n\trefs.currentPage = 1;\n\trender.clearElement(refs.productList);\n\trefs.currentQuery = li.dataset.url;\n\n\t//const vQuery = refs.currentQuery + `?limit=12&skip=${(refs.currentPage - 1) * 12}`;\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit);\n\trenderProducts(vQuery);\n});\nrefs.productList.addEventListener(\"click\", (e) => {\n\tconst prodEl = e.target.closest(\".products__item\");\n\tif (!prodEl) return;\n\n\tconsole.log(prodEl);\n\tconst prodId = prodEl.dataset.id;\n\n\tconst vQuery = refs.BASE_URL + `/${prodId}`;\n\tconsole.log(vQuery);\n\n\trenderProductsModal(vQuery);\n});\n///не читає всі товари\nrefs.load_more.addEventListener(\"click\", (e) => {\n\trefs.load_more.disabled = true;\n\trefs.currentPage++;\n\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst sym = refs.isSearch ? \"&\" : \"?\";\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit, sym);\n\tconsole.log(vQuery);\n\trenderProducts(vQuery, true);\n\n});\n\nrefs.closeBtnModal.addEventListener(\"click\", (e) => {\n\trender.hideViewElement(refs.sectionModal, 'modal--is-open');\n\t//.classList.remove('modal--is-open');\n});\nrefs.searchForm.addEventListener(\"submit\", (e) => {\n\te.preventDefault();\n\n\tlocalStorage.clear();\n\trefs.isSearch = true;\n\n\trefs.currentPage = 1;\n\t//renderTools.clearElement(renderTools.productList);\n\tconst searchData = e.currentTarget.elements['searchValue'].value.trim();\n\n\tif (!searchData) return;\n\n\tif (searchData.length < 1) return;\n\trefs.currentQuery = refs.BASE_URL + `/search?q=${searchData}`;\n\tconst vQuery = `${refs.currentQuery}&limit=${refs.defLimit}&skip=${(refs.currentPage - 1) * refs.defLimit}`;\n\t//console.log(vQuery);\n\n\trenderProducts(vQuery);\n});\n\nrefs.addToCart.addEventListener(\"click\", (e) => {\n\tstorageLib.toggleStorageItem({\n\t\tbutton: refs.addToCart,\n\t\tkey: refs.CD_DATA,\n\t\tid: refs.productID,\n\t\taddHandler: (btn, key) => storageLib.confirmAndCloseModal(btn, key, true),\n\t\tcheckHandler: storageLib.isInCardListBind,\n\t\tremoveHandler: storageLib.RemoveFromStorageBind,\n\t\tupdateButton: render.updateButtonState,\n\t\tlabelAdd: refs.TC_ADD,\n\t\tlabelRemove: refs.TC_REMOVE,\n\t\tisCard: true\n\t});\n\t//const isInStorage = storageLib.isInCardListBind(refs.CD_DATA, refs.productID);\n\t//if (isInStorage) {\n\t//\tstorageLib.StorageService.removeFromStorage(refs.CD_DATA, refs.productID, true);\n\t//} else {\n\t//\tstorageLib.confirmAndCloseModal(refs.addToCart, refs.CD_DATA, true);\n\t//}\n\t//refs.inCardList = render.updateButtonState(refs.addToCart, refs.CD_DATA, refs.TC_ADD, refs.TC_REMOVE, storageLib.isInCardListBind);\n\n\t//storageLib.updateHeader();\n});\nrefs.addToWishList.addEventListener(\"click\", (e) => {\n\tstorageLib.toggleStorageItem({\n\t\tbutton: refs.addToWishList,\n\t\tkey: refs.WL_DATA,\n\t\tid: refs.productID,\n\t\taddHandler: (btn, key) => storageLib.confirmAndCloseModal(btn, key),\n\t\tcheckHandler: storageLib.isInWishListBind,\n\t\tremoveHandler: storageLib.RemoveFromStorageBind,\n\t\tupdateButton: render.updateButtonState,\n\t\tlabelAdd: refs.TW_ADD,\n\t\tlabelRemove: refs.TW_REMOVE\n\t});\n\t//const isInStorage = storageLib.isInWishListBind(refs.WL_DATA, refs.productID);\n\t//if (isInStorage) {\n\t//\tstorageLib.StorageService.removeFromStorage(refs.WL_DATA, refs.productID);\n\t//} else {\n\t//\tstorageLib.confirmAndCloseModal(refs.addToWishList, refs.WL_DATA);\n\t//}\n\t//refs.inWishList = render.updateButtonState(refs.addToWishList, refs.WL_DATA, refs.TW_ADD, refs.TW_REMOVE, storageLib.isInWishListBind);\n\n\t//storageLib.updateHeader();\n});\n\n//////// main load\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\tconsole.log(\"Кнопка search чистить local storage\");\n\n\trenderCategories();\n});\n"],"names":["renderCategories","dataCat","apiRest.getApiData","refs","render.createMarcup","render.markUpCategories","e","renderProducts","queryLink","loadMore","render.showViewElement","render.hideViewElement","dataProd","_a","render.markUpProducts","renderProductsModal","render.markUpProductModal","render.updateButtonState","storageLib.isInWishListBind","storageLib.isInCardListBind","li","render.clearElement","cPage","vQuery","apiRest.buildQuery","prodEl","prodId","sym","searchData","storageLib.toggleStorageItem","btn","key","storageLib.confirmAndCloseModal","storageLib.RemoveFromStorageBind"],"mappings":"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"}