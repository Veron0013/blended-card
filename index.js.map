{"version":3,"file":"index.js","sources":["../src/home.js"],"sourcesContent":["//Логіка сторінки Home\nimport refs from \"./js/refs.js\";\nimport * as render from \"./js/render-function.js\";\nimport * as apiRest from \"./js/products-api.js\";\nimport * as storageLib from \"./js/storage.js\";\n\nconst renderCategories = async () => {\n\n\ttry {\n\t\tconst dataCat = await apiRest.getApiData(refs.qCategories);\n\t\t//console.log(dataCat);\n\t\trender.createMarcup(refs.categoryList, dataCat.data, render.markUpCategories, true);\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\n}\nconst renderProducts = async (queryLink, loadMore = false) => {\n\trender.addClassElement(refs.load_more, \"hidden\");\n\trender.removeClassElement(refs.divNotFound, \"not-found--visible\");\n\n\ttry {\n\t\tconst dataProd = await apiRest.getApiData(queryLink);\n\t\tconst N_F = !Array.isArray(dataProd.data?.products) || dataProd.data.products.length === 0;\n\n\t\tif (N_F) {\n\t\t\trender.addClassElement(refs.divNotFound, \"not-found--visible\");\n\t\t}\n\t\t//console.log(dataProd);\n\t\trender.createMarcup(refs.productList, dataProd.data.products, render.markUpProducts, !loadMore);\n\t\trefs.totalItems = dataProd.data.total;\n\n\t\t//console.log(refs.totalItems, refs.currentPage * refs.defLimit);\n\n\t\tif (refs.totalItems > refs.currentPage * refs.defLimit) {\n\t\t\trender.removeClassElement(refs.load_more, \"hidden\");\n\t\t}\n\t}\n\tcatch (e) {\n\t\tconsole.log(e.message);\n\t}\n\tfinally {\n\t\trefs.load_more.disabled = false;\n\t}\n}\n\nrefs.categoryList.addEventListener(\"click\", (e) => {\n\tconst li = e.target.closest(\".categories__item\");\n\tif (!li) return;\n\n\trefs.isSearch = false;\n\trefs.currentPage = 1;\n\trender.clearElement(refs.productList);\n\trefs.currentQuery = li.dataset.url;\n\n\t//const vQuery = refs.currentQuery + `?limit=12&skip=${(refs.currentPage - 1) * 12}`;\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit);\n\trenderProducts(vQuery);\n});\nrefs.productList.addEventListener(\"click\", (e) => {\n\tconst prodEl = e.target.closest(\".products__item\");\n\tif (!prodEl) return;\n\n\tconsole.log(prodEl);\n\tconst prodId = prodEl.dataset.id;\n\n\tconst vQuery = refs.BASE_URL + `/${prodId}`;\n\tconsole.log(vQuery);\n\n\trender.renderProductsModal(vQuery);\n});\n///не читає всі товари\nrefs.load_more.addEventListener(\"click\", (e) => {\n\trefs.load_more.disabled = true;\n\trefs.currentPage++;\n\n\tconst cPage = (refs.currentPage - 1) * 12\n\tconst sym = refs.isSearch ? \"&\" : \"?\";\n\tconst vQuery = apiRest.buildQuery(refs.currentQuery, cPage, refs.defLimit, sym);\n\tconsole.log(vQuery);\n\trenderProducts(vQuery, true);\n\n});\n\nrefs.closeBtnModal.addEventListener(\"click\", (e) => {\n\trender.removeClassElement(refs.sectionModal, 'modal--is-open');\n\t//.classList.remove('modal--is-open');\n});\nrefs.searchForm.addEventListener(\"submit\", (e) => {\n\te.preventDefault();\n\n\tlocalStorage.clear();\n\trefs.isSearch = true;\n\n\trefs.currentPage = 1;\n\t//renderTools.clearElement(renderTools.productList);\n\tconst searchData = e.currentTarget.elements['searchValue'].value.trim();\n\n\tif (!searchData) return;\n\n\tif (searchData.length < 1) return;\n\trefs.currentQuery = refs.BASE_URL + `/search?q=${searchData}`;\n\tconst vQuery = `${refs.currentQuery}&limit=${refs.defLimit}&skip=${(refs.currentPage - 1) * refs.defLimit}`;\n\t//console.log(vQuery);\n\n\trenderProducts(vQuery);\n});\n\nrefs.addToCart.addEventListener(\"click\", (e) => {\n\tstorageLib.toggleStorageItem({\n\t\tbutton: refs.addToCart,\n\t\tkey: refs.CD_DATA,\n\t\tid: refs.productID,\n\t\taddHandler: (btn, key) => storageLib.confirmAndCloseModal(btn, key, true),\n\t\tcheckHandler: storageLib.isInCardListBind,\n\t\tremoveHandler: storageLib.RemoveFromStorageBind,\n\t\tupdateButton: render.updateButtonState,\n\t\tlabelAdd: refs.TC_ADD,\n\t\tlabelRemove: refs.TC_REMOVE,\n\t\tisCard: true\n\t});\n\t//const isInStorage = storageLib.isInCardListBind(refs.CD_DATA, refs.productID);\n\t//if (isInStorage) {\n\t//\tstorageLib.StorageService.removeFromStorage(refs.CD_DATA, refs.productID, true);\n\t//} else {\n\t//\tstorageLib.confirmAndCloseModal(refs.addToCart, refs.CD_DATA, true);\n\t//}\n\t//refs.inCardList = render.updateButtonState(refs.addToCart, refs.CD_DATA, refs.TC_ADD, refs.TC_REMOVE, storageLib.isInCardListBind);\n\n\t//storageLib.updateHeader();\n});\nrefs.addToWishList.addEventListener(\"click\", (e) => {\n\tstorageLib.toggleStorageItem({\n\t\tbutton: refs.addToWishList,\n\t\tkey: refs.WL_DATA,\n\t\tid: refs.productID,\n\t\taddHandler: (btn, key) => storageLib.confirmAndCloseModal(btn, key),\n\t\tcheckHandler: storageLib.isInWishListBind,\n\t\tremoveHandler: storageLib.RemoveFromStorageBind,\n\t\tupdateButton: render.updateButtonState,\n\t\tlabelAdd: refs.TW_ADD,\n\t\tlabelRemove: refs.TW_REMOVE\n\t});\n\t//const isInStorage = storageLib.isInWishListBind(refs.WL_DATA, refs.productID);\n\t//if (isInStorage) {\n\t//\tstorageLib.StorageService.removeFromStorage(refs.WL_DATA, refs.productID);\n\t//} else {\n\t//\tstorageLib.confirmAndCloseModal(refs.addToWishList, refs.WL_DATA);\n\t//}\n\t//refs.inWishList = render.updateButtonState(refs.addToWishList, refs.WL_DATA, refs.TW_ADD, refs.TW_REMOVE, storageLib.isInWishListBind);\n\n\t//storageLib.updateHeader();\n});\n\n//////// main load\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\tconsole.log(\"Кнопка search чистить local storage\");\n\n\trenderCategories();\n\trender.removeClassElement(refs.searchForm, \"hidden\");\n});\n\nwindow.addEventListener(\"scroll\", () => {\n\tconsole.log(window.scrollY);\n\n\tif (window.scrollY > 600) {\n\t\trender.removeClassElement(refs.backoTop, \"hidden\");\n\t} else {\n\t\trender.addClassElement(refs.backoTop, \"hidden\");\n\t}\n});\n\nrefs.backoTop.addEventListener(\"click\", () => {\n\twindow.scrollTo({ top: 0, behavior: \"smooth\" });\n});\n"],"names":["renderCategories","dataCat","apiRest.getApiData","refs","render.createMarcup","render.markUpCategories","e","renderProducts","queryLink","loadMore","render.addClassElement","render.removeClassElement","dataProd","_a","render.markUpProducts","li","render.clearElement","cPage","vQuery","apiRest.buildQuery","prodEl","prodId","render.renderProductsModal","sym","searchData","storageLib.toggleStorageItem","btn","key","storageLib.confirmAndCloseModal","storageLib.isInCardListBind","storageLib.RemoveFromStorageBind","render.updateButtonState","storageLib.isInWishListBind"],"mappings":"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"}